import{a as G}from"./chunk-36WBY4FB.js";import{a as H}from"./chunk-CKMCQKPL.js";import{a as J,b as K}from"./chunk-TASIOQSO.js";import{a as q}from"./chunk-SDNWGHGT.js";import{b as L}from"./chunk-LFHDXIOD.js";import"./chunk-YOCH7QLI.js";import{j as Y}from"./chunk-ROWYVCHC.js";import{a as Q}from"./chunk-CYMWBMWF.js";import{a as U}from"./chunk-VM4A2UPN.js";import{d as V}from"./chunk-SWCQFAKF.js";import{a as x}from"./chunk-YCQLNCBZ.js";import{a as z}from"./chunk-VQMHI6YC.js";import"./chunk-VPUI5ZKM.js";import{Bb as N,Cb as T,Da as f,Ga as d,I as v,Ia as n,Ja as t,Jb as j,Ka as _,La as I,Ma as S,N as E,Oa as y,Pa as P,Qa as b,S as B,T as w,Va as o,W as A,Xa as c,ab as F,cb as m,da as O,db as u,ea as M,ja as k,lb as R,ta as i,ua as g,wb as D,xb as $}from"./chunk-ADDNN3XJ.js";var W=(()=>{let a=class a extends z{constructor(l){super(l),this.http=l}getAchievements(){return this.httpGetRequest("/achievements")}};a.\u0275fac=function(s){return new(s||a)(B(j))},a.\u0275prov=E({token:a,factory:a.\u0275fac,providedIn:"root"});let r=a;return r})();function ie(r,a){if(r&1&&(n(0,"li",3)(1,"p"),o(2),t(),n(3,"p"),o(4),m(5,"date"),t()()),r&2){let e=a.$implicit;i(2),c("Building name: ",e.building.name,""),i(2),c("Visit date: ",u(5,2,e.visit_date),"")}}function oe(r,a){if(r&1&&(n(0,"li",3)(1,"p"),o(2),t(),n(3,"p"),o(4),t(),n(5,"p"),o(6),m(7,"date"),t()()),r&2){let e=a.$implicit;i(2),c("Achievement title: ",e.title,""),i(2),c("Achievement description: ",e.description,""),i(2),c("Obtained: ",u(7,3,e.obtained_date),"")}}function re(r,a){if(r&1&&(I(0),n(1,"div",9)(2,"h2",10),o(3,"Visits"),t(),n(4,"ul",11),f(5,ie,6,4,"li",12),t()(),n(6,"div",9)(7,"h2",10),o(8,"Achievements"),t(),n(9,"ul",11),f(10,oe,8,5,"li",12),t()(),S()),r&2){let e=b();i(5),d("ngForOf",e.visits),i(5),d("ngForOf",e.achievements)}}function ae(r,a){r&1&&(n(0,"span",3),o(1,"visited"),t())}function le(r,a){if(r&1){let e=y();n(0,"div",21)(1,"h2",10),o(2),f(3,ae,2,0,"span",22),t(),n(4,"p",3)(5,"strong"),o(6,"Location:"),t(),_(7,"br"),o(8),_(9,"br"),o(10),t(),n(11,"p",3)(12,"strong"),o(13,"Description:"),t(),o(14),t(),n(15,"p",3)(16,"strong"),o(17,"Owner:"),t(),o(18),t(),n(19,"div")(20,"app-sb-button",6),P("buttonClicked",function(){let s=O(e).$implicit,p=b(2);return M(p.deleteBuilding(s))}),t()()()}if(r&2){let e=a.$implicit;i(2),c(" ",e==null?null:e.name," "),i(),d("ngIf",e==null?null:e.visited),i(5),c(" Latitude: ",e==null?null:e.location.latitude," "),i(2),c(" Longitude: ",e==null?null:e.location.longitude," "),i(4),c(" ",e==null?null:e.description,""),i(4),c(" ",e==null?null:e.created_by.username,""),i(2),d("buttonText","Delete Building")}}function se(r,a){if(r&1){let e=y();I(0),n(1,"div",13)(2,"div",9)(3,"h2",10),o(4,"Created Buildings"),t(),n(5,"div",14),f(6,le,21,7,"div",15),t()(),n(7,"div",16)(8,"h2",17),o(9,"Create Building"),t(),n(10,"div",18),_(11,"app-sb-input",19),t(),n(12,"div",18),_(13,"app-sb-input",19),t(),n(14,"div",18),_(15,"app-sb-input",19),t(),n(16,"div",18),_(17,"app-sb-input",19),t(),n(18,"div",20)(19,"app-sb-button",6),P("buttonClicked",function(){O(e);let s=b();return M(s.createBuilding())}),t()()()(),S()}if(r&2){let e=b();i(6),d("ngForOf",e.createdBuildings),i(5),d("control",e.getControl(e.createBuildingForm,"name"))("controlName","Name*")("placeholder","Enter building name..."),i(2),d("control",e.getControl(e.createBuildingForm,"description"))("controlName","Description*")("placeholder","Enter building description..."),i(2),d("control",e.getControl(e.createBuildingForm,"latitude"))("controlName","Latitude*")("placeholder","Enter building latitude..."),i(2),d("control",e.getControl(e.createBuildingForm,"longitude"))("controlName","Longitude*")("placeholder","Enter building longitude..."),i(2),d("buttonText","Create building")}}var ye=(()=>{let a=class a{constructor(l,s,p,C,h,X,Z,ee){this.cdRef=l,this.userInfoService=s,this.visitsApi=p,this.buildingsAPI=C,this.achievementsAPI=h,this.authAPI=X,this.router=Z,this.fb=ee,this.destroyRef$=w(k),this.userInfo$=this.userInfoService.userInfo.asObservable(),this.userRoles=J,this.visits=[],this.achievements=[],this.createdBuildings=[]}ngOnInit(){this.getLists(),this.initForm()}getLists(){this.getUserInfo().pipe(v(l=>(this.userInfoService.userInfo.next(l),l.role===this.userRoles.ADMIN?this.buildingsAPI.getUserBuildings():this.visitsApi.getVisits().pipe(v(s=>(this.visits=s,this.achievementsAPI.getAchievements()))))),x(this.destroyRef$)).subscribe(l=>{this.userInfoService.userInfo.getValue().role===this.userRoles.ADMIN?this.createdBuildings=l:this.achievements=l,this.cdRef.detectChanges()})}initForm(){this.createBuildingForm=this.fb.group({name:["Some Name"],description:["Some Description"],latitude:[55],longitude:[55]})}getUserInfo(){return this.authAPI.getUserInfo().pipe(x(this.destroyRef$))}logOut(){localStorage.clear(),this.router.navigate([U.login.routerPath])}deleteBuilding(l){this.buildingsAPI.deleteBuilding(l.id).pipe(x(this.destroyRef$)).subscribe(s=>{this.createdBuildings=this.createdBuildings.filter(p=>p.id!==l.id),this.cdRef.detectChanges()})}getControl(l,s){return l?.get(s)}createBuilding(){let{latitude:l,longitude:s,name:p,description:C}=this.createBuildingForm.getRawValue();this.buildingsAPI.createBuilding({name:p,description:C,location:{latitude:Number(l),longitude:Number(s)}}).pipe(x(this.destroyRef$)).subscribe(h=>{this.createBuildingForm.reset({},{onlySelf:!0}),this.createdBuildings.push(h),this.cdRef.detectChanges()})}};a.\u0275fac=function(s){return new(s||a)(g(R),g(K),g(G),g(H),g(W),g(Q),g(V),g(Y))},a.\u0275cmp=A({type:a,selectors:[["app-profile-page"]],standalone:!0,features:[F],decls:28,vars:16,consts:[[1,"profile-page"],[1,"profile-details"],[1,"heading-1"],[1,"medium"],[1,"profile-details__buttons"],[1,"logout"],[3,"buttonClicked","buttonText"],[1,"user-lists"],[4,"ngIf"],[1,"list-section"],[1,"heading-2"],[1,"vertical-list"],["class","medium",4,"ngFor","ngForOf"],[1,"user-lists__double"],[1,"horizontal-list"],["class","building-item",4,"ngFor","ngForOf"],[1,"login__main-form"],[1,"heading-2",2,"margin-bottom","32px"],[1,"login__main-form-control"],[3,"control","controlName","placeholder"],[1,"login__main-form-submit"],[1,"building-item"],["class","medium",4,"ngIf"]],template:function(s,p){s&1&&(n(0,"div",0)(1,"section",1)(2,"div")(3,"h1",2),o(4,"User Profile"),t(),n(5,"p",3)(6,"strong"),o(7,"Role:"),t(),o(8),m(9,"async"),t(),n(10,"p",3)(11,"strong"),o(12,"Email:"),t(),o(13),m(14,"async"),t(),n(15,"p",3)(16,"strong"),o(17,"Username:"),t(),o(18),m(19,"async"),t()(),n(20,"div",4)(21,"div",5)(22,"app-sb-button",6),P("buttonClicked",function(){return p.logOut()}),t()()()(),n(23,"section",7),f(24,re,11,2,"ng-container",8),m(25,"async"),f(26,se,20,14,"ng-container",8),m(27,"async"),t()()),s&2&&(i(8),c(" ",u(9,6,p.userInfo$).role,""),i(5),c(" ",u(14,8,p.userInfo$).email,""),i(5),c(" ",u(19,10,p.userInfo$).username,""),i(4),d("buttonText","Log out"),i(2),d("ngIf",u(25,12,p.userInfo$).role===p.userRoles.USER),i(2),d("ngIf",u(27,14,p.userInfo$).role===p.userRoles.ADMIN))},dependencies:[D,N,T,$,L,q],styles:[".heading-1[_ngcontent-%COMP%]{font:700 24px/24px Poppins,sans-serif}.heading-2[_ngcontent-%COMP%]{font:600 20px/20px Poppins,sans-serif}.heading-3[_ngcontent-%COMP%]{font:700 16px/16px Poppins,sans-serif}.medium[_ngcontent-%COMP%]{font:400 12px/12px Poppins,sans-serif}.medium-small[_ngcontent-%COMP%]{font:400 10px/10px Poppins,sans-serif}.button-text[_ngcontent-%COMP%]{font:600 16px/16px Poppins,sans-serif}.profile-page[_ngcontent-%COMP%]{background-color:#f8f9fb;padding:20px}.profile-page[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]{padding:40px 20px;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;margin-bottom:20px;display:flex;align-items:center;justify-content:space-between}.profile-page[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   .heading-1[_ngcontent-%COMP%]{margin-bottom:20px}.profile-page[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   .medium[_ngcontent-%COMP%]{margin-bottom:10px}.profile-page[_ngcontent-%COMP%]   .profile-details__buttons[_ngcontent-%COMP%]   .logout[_ngcontent-%COMP%]{margin-bottom:16px}.profile-page[_ngcontent-%COMP%]   .user-lists[_ngcontent-%COMP%]{display:flex;gap:20px;overflow-x:auto;padding:20px;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.profile-page[_ngcontent-%COMP%]   .user-lists[_ngcontent-%COMP%]   .list-section[_ngcontent-%COMP%]{min-width:300px;flex:0 0 auto}.profile-page[_ngcontent-%COMP%]   .user-lists[_ngcontent-%COMP%]   .list-section[_ngcontent-%COMP%]   .heading-2[_ngcontent-%COMP%]{margin-bottom:20px}.profile-page[_ngcontent-%COMP%]   .user-lists[_ngcontent-%COMP%]   .list-section[_ngcontent-%COMP%]   .vertical-list[_ngcontent-%COMP%]{gap:10px;padding:0;max-height:300px;overflow-y:auto}.profile-page[_ngcontent-%COMP%]   .user-lists[_ngcontent-%COMP%]   .list-section[_ngcontent-%COMP%]   .vertical-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px;background-color:#9c8ef7;padding:10px;border-radius:5px;box-shadow:0 1px 2px #0000001a}.profile-page[_ngcontent-%COMP%]   .user-lists[_ngcontent-%COMP%]   .list-section[_ngcontent-%COMP%]   .horizontal-list[_ngcontent-%COMP%]{max-height:450px;overflow-y:auto;display:grid;grid-template-columns:1fr 1fr;grid-gap:16px}.profile-page[_ngcontent-%COMP%]   .user-lists__double[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:2fr 1fr;grid-column-gap:16px}.building-item[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 4px #0000001a;transition:transform .3s,box-shadow .3s}.building-item[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 4px 8px #0003}.building-item[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:default}.building-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px}.building-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:8px}.building-item.visited[_ngcontent-%COMP%]{background-color:#fff;color:#000;border:2px solid #695FE4}.building-item.visited[_ngcontent-%COMP%]   .visit-button[_ngcontent-%COMP%]{background-color:#695fe4}.building-item.visited[_ngcontent-%COMP%]   .visit-button[_ngcontent-%COMP%]:hover, .building-item.visited[_ngcontent-%COMP%]   .visit-button[_ngcontent-%COMP%]:active{background-color:#ffe}.login__main-form-control[_ngcontent-%COMP%]{margin-bottom:16px}",".heading-1[_ngcontent-%COMP%]{font:700 24px/24px Poppins,sans-serif}.heading-2[_ngcontent-%COMP%]{font:600 20px/20px Poppins,sans-serif}.heading-3[_ngcontent-%COMP%]{font:700 16px/16px Poppins,sans-serif}.medium[_ngcontent-%COMP%]{font:400 12px/12px Poppins,sans-serif}.medium-small[_ngcontent-%COMP%]{font:400 10px/10px Poppins,sans-serif}.button-text[_ngcontent-%COMP%]{font:600 16px/16px Poppins,sans-serif}.building-page[_ngcontent-%COMP%]{padding:20px;height:100%;background-color:#f8f9fb;color:#151515;overflow-y:hidden}.building-page__title[_ngcontent-%COMP%]{margin-bottom:24px}.building-page[_ngcontent-%COMP%]   .building-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;overflow-y:auto;max-height:100%;padding-bottom:60px}.building-page[_ngcontent-%COMP%]   .building-list[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.building-page[_ngcontent-%COMP%]   .building-item[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 4px #0000001a;transition:transform .3s,box-shadow .3s}.building-page[_ngcontent-%COMP%]   .building-item[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 4px 8px #0003}.building-page[_ngcontent-%COMP%]   .building-item[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:default}.building-page[_ngcontent-%COMP%]   .building-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px}.building-page[_ngcontent-%COMP%]   .building-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:8px}.building-page[_ngcontent-%COMP%]   .building-item.visited[_ngcontent-%COMP%]{background-color:#fff;color:#000;border:2px solid #695FE4}.building-page[_ngcontent-%COMP%]   .building-item.visited[_ngcontent-%COMP%]   .visit-button[_ngcontent-%COMP%]{background-color:#695fe4}.building-page[_ngcontent-%COMP%]   .building-item.visited[_ngcontent-%COMP%]   .visit-button[_ngcontent-%COMP%]:hover, .building-page[_ngcontent-%COMP%]   .building-item.visited[_ngcontent-%COMP%]   .visit-button[_ngcontent-%COMP%]:active{background-color:#ffe}"],changeDetection:0});let r=a;return r})();export{ye as ProfilePageComponent};
