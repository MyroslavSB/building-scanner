import{a as J}from"./chunk-RAJTJGWQ.js";import{a as te}from"./chunk-SDNWGHGT.js";import{a as X,b as Y}from"./chunk-LFHDXIOD.js";import"./chunk-YOCH7QLI.js";import{b as S,d as A,j as ee}from"./chunk-ROWYVCHC.js";import{a as re}from"./chunk-CYMWBMWF.js";import{a as K}from"./chunk-VM4A2UPN.js";import{d as G,e as H}from"./chunk-SWCQFAKF.js";import{a as ne}from"./chunk-YCQLNCBZ.js";import"./chunk-VQMHI6YC.js";import{a as Q}from"./chunk-VPUI5ZKM.js";import{Ab as Z,Da as c,Ga as i,Ia as s,Ja as p,Ka as d,La as P,Ma as v,Na as R,Oa as T,Pa as N,Qa as g,T as L,Ua as y,Va as f,W as M,Xa as $,ab as U,bb as h,da as E,ea as x,fb as W,ja as k,lb as q,ta as r,ua as u,xb as j,yb as z,zb as B}from"./chunk-ADDNN3XJ.js";var w=function(e){return e.ENTER_INFO="email",e.SETUP_PASSWORD="setup-password",e}(w||{});var ie=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),oe=new RegExp(/^(?=.*\d)(?=.*[a-zа-я])(?=.*[A-ZА-Я]).{8,}$/),ae=new RegExp(/^(?=.*\d)(?=.*[!@#$%^&*.\[\]{}\-_,()])(?=.*[a-zа-я])(?=.*[A-ZА-Я]).{8,}$/),se=new RegExp(/^[a-z ,.'-]+$/i),pe=new RegExp(/^\+?[(]?[0-9]{3}[)]?[-\s.?[0-9]{3}[-\s..[0-9]{2,5}$/im),le=new RegExp(/^\+\d{1,12}$/),me=new RegExp(/\S/),ce=new RegExp(/^\S.*\S$/),ge=new RegExp(/^[0-9]+$/);var _={userEmailPattern:ie,userPasswordPattern:oe,userPasswordSpecialPattern:ae,userName:se,userPhoneNumberPattern:pe,searchPhoneNumberPattern:le,requiredFieldPattern:me,noWhiteSpacesPattern:ce,onlyDigitsPattern:ge};var l=function(e){return e.NAME_INVALID_ERROR="Name must not contain numbers or/and white spaces at the beginning, as well as special characters",e.SURNAME_INVALID_ERROR="Surname must not contain numbers or/and white spaces at the beginning, as well as special characters",e.EMAIL_INVALID_ERROR="The email address is not valid, please try again.",e.PASSWORD_INVALID_ERROR="Use at least 8 characters, 1 capital letter and 1 small letter",e.PHONE_INVALID_ERROR="Enter valid phone number",e.PASSWORD_SAME_ERROR="Passwords do not match, please try again.",e}(l||{});var C=class{static firstNameValidator(n){return n.value.match(_.userName)?null:{message:l.NAME_INVALID_ERROR}}static lastNameValidator(n){return n.value.match(_.userName)?null:{message:l.SURNAME_INVALID_ERROR}}static passwordValidator(n){return n.value.match(_.userPasswordPattern)?null:{message:l.PASSWORD_INVALID_ERROR}}static emailValidator(n){return n.value.match(_.userEmailPattern)?null:{message:l.EMAIL_INVALID_ERROR}}static phoneNumberValidator(n){return n.value.match(_.userPhoneNumberPattern)?null:{message:l.PHONE_INVALID_ERROR}}};var b=e=>({$implicit:e});function ue(e,n){e&1&&R(0)}function de(e,n){e&1&&R(0)}function _e(e,n){if(e&1){let t=T();P(0),s(1,"h3",6),f(2,"Enter your email"),p(),s(3,"div",7)(4,"div",8),d(5,"app-sb-input",9),c(6,ue,1,0,"ng-container",10),p(),s(7,"div",8),d(8,"app-sb-input",9),c(9,de,1,0,"ng-container",10),p(),s(10,"div",11)(11,"app-sb-button",12),N("buttonClicked",function(){E(t);let o=g();return x(o.verifyEmail())}),p()()(),v()}if(e&2){let t=g(),a=y(8);r(5),i("control",t.getControl(t.infoForm,"email"))("controlName","Email*")("placeholder","Enter your email..."),r(),i("ngTemplateOutlet",a)("ngTemplateOutletContext",h(11,b,t.getControl(t.infoForm,"email"))),r(2),i("control",t.getControl(t.infoForm,"username"))("controlName","Username*")("placeholder","Enter your username..."),r(),i("ngTemplateOutlet",a)("ngTemplateOutletContext",h(13,b,t.getControl(t.infoForm,"username"))),r(2),i("buttonText","Confirm")}}function Re(e,n){e&1&&R(0)}function fe(e,n){e&1&&R(0)}function he(e,n){if(e&1){let t=T();P(0),s(1,"h3",6),f(2,"Setup your password"),p(),s(3,"div",7)(4,"div",8),d(5,"app-sb-input",9),c(6,Re,1,0,"ng-container",10),p(),s(7,"div",8),d(8,"app-sb-input",9),c(9,fe,1,0,"ng-container",10),p(),s(10,"div",11)(11,"app-sb-button",12),N("buttonClicked",function(){E(t);let o=g();return x(o.regStep=o.regSteps.ENTER_INFO)}),p()(),s(12,"div",11)(13,"app-sb-button",12),N("buttonClicked",function(){E(t);let o=g();return x(o.registerUser())}),p()()(),v()}if(e&2){let t=g(),a=y(8);r(5),i("control",t.getControl(t.passwordForm,"password_1"))("controlName","Password*")("placeholder","Enter your password..."),r(),i("ngTemplateOutlet",a)("ngTemplateOutletContext",h(12,b,t.passwordForm.get("password_1"))),r(2),i("control",t.getControl(t.passwordForm,"password_2"))("controlName","Password*")("placeholder","Repeat your password..."),r(),i("ngTemplateOutlet",a)("ngTemplateOutletContext",h(14,b,t.passwordForm.get("password_2"))),r(2),i("buttonText","Back"),r(2),i("buttonText","Setup password")}}function Se(e,n){if(e&1&&(s(0,"p",14),d(1,"app-base-icon",15),f(2),p()),e&2){let t=g().$implicit;r(),i("name","warning_icon"),r(),$(" ",t.errors==null?null:t.errors.message," ")}}function we(e,n){if(e&1&&c(0,Se,3,2,"p",13),e&2){let t=n.$implicit;i("ngIf",t.touched&&t.dirty&&t.errors)}}var Ke=(()=>{let n=class n{constructor(a,o,m,O,I){this.cdRef=a,this.fb=o,this.authAPI=m,this.localStorage=O,this.router=I,this.destroyRef=L(k),this.regSteps=w,this.regStep=w.ENTER_INFO,this.storageItems=Q,this.appRoutes=K,this.passwordsValidator=V=>{let D=V.get("password_1")?.value,F=V.get("password_2")?.value;return D&&F?D===F?null:{message:l.PASSWORD_SAME_ERROR}:null},this.ERegSteps=w}ngOnInit(){this.initForms()}initForms(){this.infoForm=this.fb.group({email:new A("",[S.required,C.emailValidator]),username:new A("",[S.required])}),this.passwordForm=this.fb.group({password_1:["",[S.required,C.passwordValidator]],password_2:["",[S.required]]},{validators:[this.passwordsValidator]})}verifyEmail(){this.regStep=this.regSteps.SETUP_PASSWORD,this.cdRef.detectChanges()}setupPassword(){this.cdRef.detectChanges()}registerUser(){let{email:a,username:o}=this.infoForm.getRawValue(),{password_1:m}=this.passwordForm.getRawValue(),O={email:a,username:o,password:m};this.authAPI.register(O).pipe(ne(this.destroyRef)).subscribe(I=>{this.localStorage.setItem(this.storageItems.ACCESS_TOKEN,I.access_token),this.router.navigate([this.appRoutes.home_page.routerPath])})}getControl(a,o){return a?.get(o)}};n.\u0275fac=function(o){return new(o||n)(u(q),u(ee),u(re),u(J),u(G))},n.\u0275cmp=M({type:n,selectors:[["app-registration-page"]],standalone:!0,features:[U],decls:9,vars:4,consts:[["fieldError",""],[1,"reg-page"],[1,"reg-page__main"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"medium-small",2,"margin-top","16px","cursor","pointer",3,"routerLink"],[1,"reg-page__main-title","heading-1"],[1,"reg-page__main-form"],[1,"reg-page__main-form-control"],[3,"control","controlName","placeholder"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"reg-page__main-form-submit"],[3,"buttonClicked","buttonText"],["class","field-error medium-small",4,"ngIf"],[1,"field-error","medium-small"],[3,"name"]],template:function(o,m){o&1&&(s(0,"div",1)(1,"div",2),P(2,3),c(3,_e,12,15,"ng-container",4)(4,he,14,16,"ng-container",4),v(),s(5,"a",5),f(6," Login to account "),p()()(),c(7,we,1,1,"ng-template",null,0,W)),o&2&&(r(2),i("ngSwitch",m.regStep),r(),i("ngSwitchCase",m.regSteps.ENTER_INFO),r(),i("ngSwitchCase",m.regSteps.SETUP_PASSWORD),r(),i("routerLink",m.appRoutes.login.fullPath))},dependencies:[z,B,Y,te,X,j,Z,H],styles:[".reg-page[_ngcontent-%COMP%]{padding-top:180px}.reg-page__main[_ngcontent-%COMP%]{width:max-content;margin:0 auto}.reg-page__main-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:64px}.reg-page__main-form-control[_ngcontent-%COMP%]{width:300px;margin-bottom:16px}.reg-page__main-form-submit[_ngcontent-%COMP%]{width:300px;height:48px;margin:32px auto 0}"],changeDetection:0});let e=n;return e})();export{Ke as RegistrationPageComponent};
